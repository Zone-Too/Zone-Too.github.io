<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/silver/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dumupro.top","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="写在最前：该系统是一次课程设计，仅供参考。源码地址：Zone-Too&#x2F;Jspclasswork (github.com)">
<meta property="og:type" content="article">
<meta property="og:title" content="Jsp课程设计（学生信息管理系统）">
<meta property="og:url" content="http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/index.html">
<meta property="og:site_name" content="DUMUPRO">
<meta property="og:description" content="写在最前：该系统是一次课程设计，仅供参考。源码地址：Zone-Too&#x2F;Jspclasswork (github.com)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF.png">
<meta property="article:published_time" content="2021-10-25T10:56:18.000Z">
<meta property="article:modified_time" content="2021-10-25T11:11:21.229Z">
<meta property="article:author" content="杜沐">
<meta property="article:tag" content="-Jsp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF.png">


<link rel="canonical" href="http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/","path":"2021/10/25/Jsp课程设计（学生信息管理系统）/","title":"Jsp课程设计（学生信息管理系统）"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Jsp课程设计（学生信息管理系统） | DUMUPRO</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?08ae219bfdf992537a81b605c6267ba0"></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">DUMUPRO</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">杜沐 的 博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%85%B7%EF%BC%9A"><span class="nav-number">1.</span> <span class="nav-text">一、使用工具：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%8A%9F%E8%83%BD%E6%A6%82%E8%BF%B0"><span class="nav-number">2.</span> <span class="nav-text">二、功能概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E9%A1%B9%E7%9B%AE%E6%9E%B6%E6%9E%84%E6%80%9D%E8%B7%AF"><span class="nav-number">3.</span> <span class="nav-text">三、项目架构思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91"><span class="nav-number">4.</span> <span class="nav-text">四、项目开发</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA"><span class="nav-number">4.1.</span> <span class="nav-text">1、项目创建</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81%E6%B3%A8%E5%86%8C%E7%9A%84%E6%B5%81%E7%A8%8B%EF%BC%88register%EF%BC%89"><span class="nav-number">4.2.</span> <span class="nav-text">2、注册的流程（register）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%E3%80%81%E7%99%BB%E5%BD%95%E7%9A%84%E6%B5%81%E7%A8%8B%EF%BC%88login%EF%BC%89"><span class="nav-number">4.3.</span> <span class="nav-text">3、登录的流程（login）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4%E3%80%81%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="nav-number">4.4.</span> <span class="nav-text">4、修改用户的流程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5%E3%80%81%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7"><span class="nav-number">4.5.</span> <span class="nav-text">5、删除用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6%E3%80%81%E5%A2%9E%E5%8A%A0%E4%B8%80%E5%90%8D%E7%94%A8%E6%88%B7"><span class="nav-number">4.6.</span> <span class="nav-text">6、增加一名用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7%E3%80%81%E7%B2%BE%E5%87%86%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.7.</span> <span class="nav-text">7、精准查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#8%E3%80%81%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.8.</span> <span class="nav-text">8、模糊查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9%E3%80%81%E5%85%A8%E5%B1%80%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="nav-number">4.9.</span> <span class="nav-text">9、全局模糊查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10%E3%80%81%E7%94%A8%E6%88%B7%E7%9A%84%E9%80%80%E5%87%BA"><span class="nav-number">4.10.</span> <span class="nav-text">10、用户的退出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11%E3%80%81%E5%85%B3%E4%BA%8E%E5%88%86%E9%A1%B5%E6%9C%89%E5%87%A0%E7%82%B9%E6%83%B3%E8%AF%B4%E7%9A%84"><span class="nav-number">4.11.</span> <span class="nav-text">11、关于分页有几点想说的</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E6%96%B9%E9%9D%A2%E7%9A%84%E8%A1%A5%E5%85%85%EF%BC%88DBHelper%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">五、数据库方面的补充（DBHelper）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">6.</span> <span class="nav-text">六、总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="杜沐"
      src="/images/avatar2.jpg">
  <p class="site-author-name" itemprop="name">杜沐</p>
  <div class="site-description" itemprop="description">功不唐捐</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="mailto:1539011985@qq.com" title="E-Mail → mailto:1539011985@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/7312045349" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7312045349" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.csdn.net/" title="https:&#x2F;&#x2F;www.csdn.net&#x2F;" rel="noopener" target="_blank">CSDN</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://cn.aliyun.com/" title="https:&#x2F;&#x2F;cn.aliyun.com&#x2F;" rel="noopener" target="_blank">阿里云</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://dumupro.top/2021/10/25/Jsp%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1%EF%BC%88%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar2.jpg">
      <meta itemprop="name" content="杜沐">
      <meta itemprop="description" content="功不唐捐">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DUMUPRO">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Jsp课程设计（学生信息管理系统）
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-10-25 18:56:18 / 修改时间：19:11:21" itemprop="dateCreated datePublished" datetime="2021-10-25T18:56:18+08:00">2021-10-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Jsp/" itemprop="url" rel="index"><span itemprop="name">Jsp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>写在最前：该系统是一次课程设计，<strong>仅供参考</strong>。<strong>源码地址：</strong><a target="_blank" rel="noopener" href="https://github.com/Zone-Too/Jspclasswork">Zone-Too/Jspclasswork (github.com)</a></p>
<span id="more"></span>

<h4 id="一、使用工具："><a href="#一、使用工具：" class="headerlink" title="一、使用工具："></a>一、使用工具：</h4><p><strong>jsp</strong> + <strong>JavaScript</strong> + <strong>servlet</strong> + <strong>Apache-Tomcat v9.0</strong> +  <strong>MySql</strong> + <strong>jdk13</strong> + <strong>ecplise</strong></p>
<h4 id="二、功能概述"><a href="#二、功能概述" class="headerlink" title="二、功能概述"></a>二、功能概述</h4><p>1、该项目为学生信息管理系统，首先要完成的功能是用户的<strong>注册</strong>、管理员的<strong>登录</strong>、管理员对用户数据的<strong>增删改查</strong>。</p>
<p>2、在登录页面上实现<strong>验证码登录</strong>功能</p>
<p>3、在管理员的运行界面以<strong>分页</strong>的形式显示所有的用户信息（代码过程中出现分页相关的知识，会放在文章后面着重解析）</p>
<p>4、实现全功能的<strong>模糊查询</strong></p>
<p>5、实现用户<strong>昵称相同，不可注册</strong></p>
<p>6、对程序各处进行优化处理，防止出现功能不全问题</p>
<h4 id="三、项目架构思路"><a href="#三、项目架构思路" class="headerlink" title="三、项目架构思路"></a>三、项目架构思路</h4><p>1、项目<strong>采用MVC架构</strong>，view层：jsp;  controller层：servlet；model层：dao；</p>
<p>2、<strong>运行的大体流程如下</strong>: 用户在jsp页面（view层）上提交申请到servlet（controller），servlet（controller）看是否需要与数据库进行交互，决定是否要进入Dao（model）层与数据库进行交互。Dao层处理完后，把数据返回给servlet进行下一把处理，处理完成后servlet把数据传给jsp页面（view层）进行显示。</p>
<h4 id="四、项目开发"><a href="#四、项目开发" class="headerlink" title="四、项目开发"></a>四、项目开发</h4><h5 id="1、项目创建"><a href="#1、项目创建" class="headerlink" title="1、项目创建"></a>1、项目创建</h5><p>​        使用ecplise，新建一个dynamic web project，命名为login。</p>
<p>​        用户对象的创建（User）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.ujn.model;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">	<span class="keyword">private</span> String username;</span><br><span class="line">	<span class="keyword">private</span> String password;</span><br><span class="line">	<span class="keyword">private</span> String sex;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	<span class="keyword">private</span> String hobit;</span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line">	<span class="keyword">private</span> String address;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sex;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getHobit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> hobit;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHobit</span><span class="params">(String hobit)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.hobit = hobit;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> address;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(String address)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.address = address;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.username = username;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> password;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.password = password;</span><br><span class="line">	&#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2、注册的流程（register）"><a href="#2、注册的流程（register）" class="headerlink" title="2、注册的流程（register）"></a>2、注册的流程（register）</h5><p>​    2.1、View层的编写（register.jsp）：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span> pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;`</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.Date&quot;</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;用户注册&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;!-- 表单验证 --&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="comment">/*js判断输入框中是否填写东西，也可以使用 &lt;input/&gt; 的一个属性reqired来限制用户必须要进行输入*/</span></span><br><span class="line">	<span class="function">function <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> inputdate = document.getElementById(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入注册的用户名&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入注册的密码&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入注册的年龄&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入注册的邮箱&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入注册的地址&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;form action=<span class="string">&quot;UserServlet?action=register&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return check()&quot;</span>&gt;</span><br><span class="line">  	用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> id =<span class="string">&quot;username&quot;</span>/&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	密码：&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span> id =<span class="string">&quot;password&quot;</span>/&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	性别：&lt;input type=<span class="string">&quot;radio&quot;</span> name =<span class="string">&quot;sex&quot;</span> value =<span class="string">&quot;男&quot;</span> &gt;男</span><br><span class="line">  		&lt;input type=<span class="string">&quot;radio&quot;</span> name =<span class="string">&quot;sex&quot;</span> value =<span class="string">&quot;女&quot;</span>&gt;女&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	年龄：&lt;input type=<span class="string">&quot;text&quot;</span> name =<span class="string">&quot;age&quot;</span> id=<span class="string">&quot;age&quot;</span>&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	爱好：&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;看电影&quot;</span> &gt;看电影</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;听音乐&quot;</span>&gt;听音乐</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;读书&quot;</span>&gt;读书</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;跑步&quot;</span>&gt;跑步&lt;br&gt;&lt;br&gt;</span><br><span class="line">  	邮箱：&lt;input type=<span class="string">&quot;email&quot;</span> name = <span class="string">&quot;email&quot;</span> id=<span class="string">&quot;email&quot;</span>&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	家庭地址：&lt;input type =<span class="string">&quot;text&quot;</span> name =<span class="string">&quot;address&quot;</span> id = <span class="string">&quot;address&quot;</span>&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	&lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;注册&quot;</span>/&gt;</span><br><span class="line">  &lt;/form&gt;&lt;br&gt;</span><br><span class="line">已经有账号了，点击&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;这里&lt;/a&gt;去登陆</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>​    2.2、Controller层的编写（servlet）：</p>
<p>​        首先在java resource的src下建立一个包，以反写域名的形式命名，如：cn.ujn.edu.servlet，在这个包下建立一个servlet类，命名为Userservlet。servlet中的doGet( ) 和 doPost( ) 分别用来处理以get方式和post方式提交的表单数据，所以一般情况下两个方法中实现的方法应该是一样的，故在dopost( )方法中调用doget( )方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">			<span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    <span class="comment">//调用doGet()</span></span><br><span class="line">		doGet(request, response);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>​        doget( )：有些操作是要在所有页面都要共用的，比如中文乱码的解决，用户的用户名（username）、用户的密码（password）的获取、与数据库操作相关的dao层的建立以及表单action属性的获取（servlet通过 if 来判断action的值来判断具体要执行那一段代码，如register.jsp中form里的action值为register，后面servlet会调用register的相关方法【见后】）。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//解决中文乱码问题</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="comment">//用户名和密码的获取</span></span><br><span class="line">String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"><span class="comment">//与数据库相关操作的Dao层的处理</span></span><br><span class="line">IUserDao userDao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"><span class="comment">//action属性的获取</span></span><br><span class="line">String action = request.getParameter(<span class="string">&quot;action&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>​          获取action的值为register之后的操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对比action里的值为register执行if中的代码</span></span><br><span class="line"><span class="keyword">if</span> (action.equals(<span class="string">&quot;register&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//获取表单中的数据（实际上是地址栏中的数据，只是post方法传输的，数据被隐藏了）。</span></span><br><span class="line">    <span class="comment">//以下性别、年龄、爱好、邮箱、地址都应该在register的方法中获取，因为其他页面的变淡不包括这些属性。</span></span><br><span class="line">			String sex = request.getParameter(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">			<span class="keyword">int</span> age = Integer.parseInt(request.getParameter(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">			String[] hobits = request.getParameterValues(<span class="string">&quot;hobit&quot;</span>);</span><br><span class="line">			String hobit = <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;hobits.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">				hobit = hobit + hobits[i] + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			hobit = hobit + hobits[hobits.length-<span class="number">1</span>];</span><br><span class="line">			String email = request.getParameter(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">			String address = request.getParameter(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">   	<span class="comment">//把获取到的数据存在一个user对象中，并把这个user对象作为参数传递给dao层的方法进行处理</span></span><br><span class="line">			User user = <span class="keyword">new</span> User();</span><br><span class="line">			user.setPassword(password);</span><br><span class="line">			user.setUsername(username);</span><br><span class="line">			user.setSex(sex);</span><br><span class="line">			user.setAge(age);</span><br><span class="line">			user.setHobit(hobit);</span><br><span class="line">			user.setEmail(email);</span><br><span class="line">			user.setAddress(address);</span><br><span class="line">    <span class="comment">//调用checkUsername()检查用户是否已经注册，已经注册了就不让再注册了</span></span><br><span class="line">			<span class="keyword">if</span> (userDao.checkUsername(user)) &#123;</span><br><span class="line">				response.getWriter().println(<span class="string">&quot;用户名已存在，即将为您重新跳转至登录册页面&quot;</span>);</span><br><span class="line">                <span class="comment">//用户已经注册了就跳转到login.jsp页面</span></span><br><span class="line">				response.setHeader(<span class="string">&quot;refresh&quot;</span>, <span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//用户没有存在在数据库中，可以进行用户注册，执行以下代码</span></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="keyword">if</span> (userDao.register(user)) &#123;</span><br><span class="line">						response.getWriter().println(<span class="string">&quot;注册成功，3秒后返回登录页面&quot;</span>);</span><br><span class="line">                        <span class="comment">//3秒钟跳转到login.jsp页面上</span></span><br><span class="line">						response.setHeader(<span class="string">&quot;refresh&quot;</span>, <span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">					&#125; <span class="keyword">else</span></span><br><span class="line">                        <span class="comment">//在页面上显示一句话</span></span><br><span class="line">						response.getWriter().println(<span class="string">&quot;注册失败！&quot;</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​         2.3、Model层的编写（Dao层）：</p>
<p>​            主要与数据可以打交道，由servlet调用</p>
<p>​     checkUsername( )：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkUsername</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//通过DBHelper建立一个与数据库的链接（DBHelper的使用见后）</span></span><br><span class="line">			Connection con = DBHelper.getConnection();</span><br><span class="line">            <span class="comment">//编写sql语句</span></span><br><span class="line">			String sql = <span class="string">&quot;select * from user where username=?&quot;</span>;</span><br><span class="line">            <span class="comment">//预处理sql语句</span></span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//设置sql语句的的第一个？</span></span><br><span class="line">			st.setString(<span class="number">1</span>, user.getUsername());</span><br><span class="line">            <span class="comment">//执行sql语句，返回执行结果rs，用executeQuery()</span></span><br><span class="line">			ResultSet rs=st.executeQuery();</span><br><span class="line">			<span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line">                <span class="comment">//查找第一列的数据如果不为空，返回true，代表用户已经存在了</span></span><br><span class="line">				<span class="keyword">if</span> (rs.getString(<span class="number">1</span>)!=<span class="keyword">null</span>) &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                <span class="comment">//没有查找到同名的用户代表数据库没有这个人，可以进行注册，返回false</span></span><br><span class="line">				&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">//三个关闭</span></span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>​         register( ):</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">register</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		Connection con = DBHelper.getConnection();</span><br><span class="line">		String sql = <span class="string">&quot;insert into user(username,password,sex,age,hobit,email,address) values(?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">		PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">		st.setString(<span class="number">1</span>, user.getUsername());</span><br><span class="line">		st.setString(<span class="number">2</span>, user.getPassword());	</span><br><span class="line">		st.setString(<span class="number">3</span>, user.getSex());</span><br><span class="line">		st.setInt(<span class="number">4</span>, user.getAge());</span><br><span class="line">		st.setString(<span class="number">5</span>, user.getHobit());</span><br><span class="line">		st.setString(<span class="number">6</span>, user.getEmail());</span><br><span class="line">		st.setString(<span class="number">7</span>, user.getAddress());</span><br><span class="line"><span class="comment">//与查找不一样，更新、插入、删除都要用的是executeUpdate()，返回执行成功的条数</span></span><br><span class="line">		<span class="keyword">int</span> n = st.executeUpdate();</span><br><span class="line">		st.close();</span><br><span class="line">		con.close();</span><br><span class="line">		<span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">		System.out.println(ce);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        随后register流程结束，通过response.setHeader(“refresh”, “3;url=login.jsp”);跳转到login.jsp页面，随后进入登录的MVC流程</p>
<h5 id="3、登录的流程（login）"><a href="#3、登录的流程（login）" class="headerlink" title="3、登录的流程（login）"></a>3、登录的流程（login）</h5><p>​        3.1、View层的编写（login.jsp）：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;后台登陆界面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">    <span class="comment">/*js判断输入框中是否填写东西，也可以使用 &lt;input/&gt; 的一个属性reqired来限制用户必须要进行输入*/</span></span><br><span class="line">	<span class="function">function <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> inputdate = document.getElementById(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入名字&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入密码&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/* 验证码的重新获取，onclick=&quot;reget(this)&quot;调用方法，重新获取验证图片 */</span></span><br><span class="line">	<span class="function">function <span class="title">reget</span><span class="params">(code)</span></span>&#123;</span><br><span class="line">		code.src=<span class="string">&quot;UserServlet?action=code&amp;time=&quot;</span> + <span class="keyword">new</span> Date().getTime();</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//pagesize 设置分页一页显示内容的多少</span></span><br><span class="line">	<span class="keyword">int</span> pagesize =<span class="number">7</span>;</span><br><span class="line">%&gt;</span><br><span class="line"> &lt;form action=<span class="string">&quot;UserServlet?action=login&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return check()&quot;</span>&gt;</span><br><span class="line">  	用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> id=<span class="string">&quot;username&quot;</span>/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br&gt;</span><br><span class="line">  	密码：&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span> id=<span class="string">&quot;password&quot;</span> /&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	&lt;label&gt; 验证码：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;checkcode&quot;</span> /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;!-- 验证码在页面上的获取方法 --&gt;</span><br><span class="line">  	&lt;img  src=<span class="string">&quot;UserServlet?action=code&quot;</span> onclick=<span class="string">&quot;reget(this)&quot;</span> width=100px height=35px  &gt;&lt;/label&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">  	&lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;登录&quot;</span>/&gt;</span><br><span class="line">  	&lt;input type=<span class="string">&quot;reset&quot;</span> value=<span class="string">&quot;重置&quot;</span> /&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">  &lt;br/&gt;&lt;br/&gt;</span><br><span class="line">    &lt;!-- 创建注册的链接，增加用户的体验 --&gt;</span><br><span class="line">  还没有账号？&amp;nbsp;点击&lt;a href=<span class="string">&quot;register.jsp&quot;</span>&gt;这里&lt;/a&gt;注册！</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>​        3.2、Controller层的编写（servlet）：</p>
<p>​        与register的流程类似，具体代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对比action里的值为login执行if中的代码</span></span><br><span class="line"><span class="keyword">if</span> (action.equals(<span class="string">&quot;login&quot;</span>)) &#123;</span><br><span class="line">    <span class="comment">//获取到的username和password作为调用的dao层的方法的参数</span></span><br><span class="line">			User user=userDao.login(username, password);</span><br><span class="line">    <span class="comment">//获取pagesize，用于处理分页</span></span><br><span class="line">			String pagesize =request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">    <span class="comment">//从session中获取系统生成的验证码信息，并把session中获取的object转化为String</span></span><br><span class="line">			String picture_code = request.getSession().getAttribute(<span class="string">&quot;picture_code&quot;</span>).toString();</span><br><span class="line">    <span class="comment">//获取用户输入的验证码信息</span></span><br><span class="line">			String checkcode = request.getParameter(<span class="string">&quot;checkcode&quot;</span>);</span><br><span class="line">    <span class="comment">//验证用户是不是存在和输入的验证码是不是对的</span></span><br><span class="line">			<span class="keyword">if</span> (user != <span class="keyword">null</span> &amp;&amp; checkcode.equals(picture_code)) &#123;</span><br><span class="line">                <span class="comment">//用户登录成功后，把用户的名字存在session中</span></span><br><span class="line">				request.getSession().setAttribute(<span class="string">&quot;activeuser&quot;</span>, user.getUsername());</span><br><span class="line">                <span class="comment">//调用response.sendRedirect（）重定向到findall查询所有用户的信息</span></span><br><span class="line">				response.sendRedirect(<span class="string">&quot;UserServlet?action=findall&amp;pagesize=&quot;</span>+pagesize);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				response.sendRedirect(<span class="string">&quot;login.jsp&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​    验证码的生成代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 验证码</span></span><br><span class="line">		<span class="keyword">if</span> (action.equals(<span class="string">&quot;code&quot;</span>)) &#123;</span><br><span class="line">			<span class="comment">// BufferedImage类用来处理和操纵图像数据，所有 BufferedImage 对象的左上角坐标为（0,0）</span></span><br><span class="line">			<span class="comment">// 定义BufferedImage对象</span></span><br><span class="line">			BufferedImage bImage = <span class="keyword">new</span> BufferedImage(<span class="number">68</span>, <span class="number">22</span>, BufferedImage.TYPE_INT_RGB);<span class="comment">// 图像类型不透明</span></span><br><span class="line">			<span class="comment">// 获得Graphics对象</span></span><br><span class="line">			Graphics graphics = bImage.getGraphics();</span><br><span class="line">			<span class="comment">// 构建一个颜色</span></span><br><span class="line">			Color color = <span class="keyword">new</span> Color(<span class="number">200</span>, <span class="number">150</span>, <span class="number">255</span>);</span><br><span class="line">			<span class="comment">// 设置颜色</span></span><br><span class="line">			graphics.setColor(color);</span><br><span class="line">			<span class="comment">// 填充区域</span></span><br><span class="line">			graphics.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">68</span>, <span class="number">22</span>);</span><br><span class="line">			<span class="comment">// 定义一个数组来存放用来随机的字母和数字</span></span><br><span class="line">			<span class="keyword">char</span>[] ch = <span class="string">&quot;QWERTYUIOPLKJHGFDSAZXCVBNM0123456789&quot;</span>.toCharArray();</span><br><span class="line">			<span class="comment">// 定义一个随机对象</span></span><br><span class="line">			Random r = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">			<span class="keyword">int</span> len = ch.length;</span><br><span class="line">			<span class="keyword">int</span> index;</span><br><span class="line">			String str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">				<span class="comment">// 产生一个随机数</span></span><br><span class="line">				index = r.nextInt(len);</span><br><span class="line">				<span class="comment">// 随机设置一个颜色,跟背景颜色相区别</span></span><br><span class="line">				graphics.setColor(<span class="keyword">new</span> Color(r.nextInt(<span class="number">88</span>), r.nextInt(<span class="number">188</span>), r.nextInt(<span class="number">255</span>)));</span><br><span class="line">				<span class="comment">// 使用Graphics绘制字符串</span></span><br><span class="line">				graphics.drawString(ch[index] + <span class="string">&quot;&quot;</span>, (i * <span class="number">15</span>) + <span class="number">5</span>, <span class="number">16</span>);</span><br><span class="line">				str += ch[index];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// 将验证码信息存入session中</span></span><br><span class="line">			request.getSession().setAttribute(<span class="string">&quot;picture_code&quot;</span>, str);</span><br><span class="line">			<span class="comment">// 使用ImageIO输出图片</span></span><br><span class="line">			ImageIO.write(bImage, <span class="string">&quot;JPG&quot;</span>, response.getOutputStream());</span><br><span class="line"></span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​     用户密码和验证码都通过了，随后再次进入servlet，action被赋值为finall，则会执行finall里面的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//		查询所有信息</span></span><br><span class="line">		<span class="keyword">if</span>(action.equals(<span class="string">&quot;findall&quot;</span>)) &#123;</span><br><span class="line"><span class="comment">//      调用Dao层的方法findUsers（），查询所有的用户，则用一个链表来接收返回值，传入的数据，分别是分页的第一页和分页的每一页的内容多少（具体实现见后‘分页部分’）</span></span><br><span class="line">			ArrayList&lt;User&gt; userlist=userDao.findUsers(<span class="number">1</span>,Integer.parseInt(request.getParameter(<span class="string">&quot;pagesize&quot;</span>)));</span><br><span class="line"><span class="comment">//         把查询的用户链表存在request里，类似存在了一个内存中，只是这个请求结束后，这个内存也不存在了</span></span><br><span class="line">			request.setAttribute(<span class="string">&quot;userList&quot;</span>, userlist);</span><br><span class="line">            <span class="comment">//请求转发到success.jsp,通过下面这种方法，可以把request的数据传到下一个页面，即success.jsp页面</span></span><br><span class="line">			request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​        3.3、Model层的编写（Dao层）</p>
<p>​    login（ ）:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">login</span><span class="params">(String username, String password)</span> </span>&#123;</span><br><span class="line">	User user = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		Connection con = DBHelper.getConnection(); </span><br><span class="line">		String sql = <span class="string">&quot;select * from user where username=? and password=?&quot;</span>;</span><br><span class="line">		PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">		st.setString(<span class="number">1</span>, username);</span><br><span class="line">		st.setString(<span class="number">2</span>, password);</span><br><span class="line">           <span class="comment">//查询的执行语句是executeQuery()，返回的是查询的结果，不是执行成功的条数</span></span><br><span class="line">		ResultSet rs = st.executeQuery();</span><br><span class="line">		<span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">			user = <span class="keyword">new</span> User();</span><br><span class="line">			user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">			user.setUsername(rs.getString(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">			user.setPassword(rs.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">			user.setSex(rs.getString(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line">			user.setAge(rs.getInt(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">			user.setHobit(rs.getString(<span class="string">&quot;hobit&quot;</span>));</span><br><span class="line">			user.setEmail (rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">			user.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		rs.close();</span><br><span class="line">		st.close();</span><br><span class="line">		con.close();</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">		System.out.println(ce);</span><br><span class="line">		<span class="keyword">return</span> user;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>findUsers( )：</p>
<p>​        以分页的形式查询数据库中的信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;User&gt; <span class="title">findUsers</span><span class="params">(<span class="keyword">int</span> currentpage,<span class="keyword">int</span> pagesize)</span> </span>&#123;</span><br><span class="line">		User user = <span class="keyword">null</span>;</span><br><span class="line">		ArrayList&lt;User&gt; userList=<span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection(); </span><br><span class="line">			String sql = <span class="string">&quot;select * from user limit ?,?&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//(currentpage-1)*pagesize计算当前页第一位数据是列表中的第几条，用于分页</span></span><br><span class="line">			st.setInt(<span class="number">1</span>, (currentpage-<span class="number">1</span>)*pagesize);</span><br><span class="line">			st.setInt(<span class="number">2</span>, pagesize);</span><br><span class="line">			ResultSet rs = st.executeQuery();</span><br><span class="line">            <span class="comment">//多条数据用while</span></span><br><span class="line">			<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">				user = <span class="keyword">new</span> User();</span><br><span class="line">				user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">				user.setUsername(rs.getString(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">				user.setPassword(rs.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">				user.setSex(rs.getString(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line">				user.setAge(rs.getInt(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">				user.setHobit(rs.getString(<span class="string">&quot;hobit&quot;</span>));</span><br><span class="line">				user.setEmail (rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">				user.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">                <span class="comment">//把查询到的每一位用户存在userlist里</span></span><br><span class="line">				userList.add(user);</span><br><span class="line">			&#125;</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">return</span> userList;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>​      3.4、View的展示（success.jsp）</p>
<p>​        该页面上实现了精准查询、模糊查询（源码中没有实现全局模糊查询，在文档中说明实现方法）、增加用户、修改用户、删除用户、以及个人页面的展示。</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.model.User&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.dao.IUserDao&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.dao.UserDaoImpl&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;用户信息主界面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">	<span class="function">function <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> inputdate = document.getElementById(<span class="string">&quot;search-uid&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入你要查询的id&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">function <span class="title">check2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> inputdate = document.getElementById(<span class="string">&quot;search-uname&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入你要查询的字段&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">    <span class="comment">//有关当前页（currentpage）和页面条数（pagesize）的设置</span></span><br><span class="line">	<span class="keyword">int</span> currentpage=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> pagesize = <span class="number">7</span>;</span><br><span class="line">	IUserDao userdao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line">	<span class="keyword">int</span> pagecount = userdao.getPageCount(pagesize);</span><br><span class="line">	<span class="keyword">if</span>(request.getParameter(<span class="string">&quot;currentpage&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">		currentpage = Integer.parseInt(request.getParameter(<span class="string">&quot;currentpage&quot;</span>));</span><br><span class="line">		currentpage = currentpage&lt;<span class="number">1</span>?<span class="number">1</span>:currentpage;</span><br><span class="line">	&#125;</span><br><span class="line">	%&gt;</span><br><span class="line"></span><br><span class="line">	&lt;%</span><br><span class="line">    <span class="comment">//如果用户没有登陆则不能显示if里的语句（即显示页面），用来实现用户不登录不能打开除登录、注册以外的界面，这一段代码在很多地方都会用到，写法也一样。</span></span><br><span class="line">	<span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;activeuser&quot;</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">	out.println(session.getAttribute(<span class="string">&quot;activeuser&quot;</span>)+<span class="string">&quot;登录成功！&quot;</span>);	</span><br><span class="line">	ArrayList&lt;User&gt; userlist=(ArrayList&lt;User&gt;)request.getAttribute(<span class="string">&quot;userList&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(userlist!=<span class="keyword">null</span>&amp;&amp;userlist.size()&gt;<span class="number">0</span>)&#123; %&gt;</span><br><span class="line">		&lt;table border=<span class="string">&quot;1&quot;</span>&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;th&gt;ID&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;用户名&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;密码&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;性别&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;年龄&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;爱好&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;邮箱&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;地址&lt;/th&gt;</span><br><span class="line">				&lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">			&lt;% <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;userlist.size();i++)&#123; %&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getId() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;a href = <span class="string">&quot;showoneuser.jsp?userid=&lt;%=userlist.get(i).getId() %&gt;&amp;pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=currentpage %&gt;&quot;</span>&gt;&lt;%=userlist.get(i).getUsername() %&gt;&lt;a/&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getPassword() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getSex() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getAge() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getHobit() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getEmail() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;%=userlist.get(i).getAddress() %&gt;&lt;/td&gt;</span><br><span class="line">			  &lt;td&gt;&lt;a href = <span class="string">&quot;updateuser.jsp?userid=&lt;%=userlist.get(i).getId() %&gt;&amp;pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=currentpage %&gt;&quot;</span>&gt;修改用户&lt;/a&gt;&amp;nbsp;&amp;nbsp; &lt;a href =<span class="string">&quot;UserServlet?action=deleteoneuser&amp;userid=&lt;%=userlist.get(i).getId() %&gt;&amp;pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=currentpage %&gt;&quot;</span>&gt;删除用户&lt;/a&gt; &lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">		&lt;% &#125;</span><br><span class="line">     	%&gt;	&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">     	&lt;a href = <span class="string">&quot;adduser.jsp?pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=pagecount %&gt;&quot;</span>&gt;添加一名用户&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">     	&lt;a href = <span class="string">&quot;logout.jsp&quot;</span>&gt;退出登录&lt;/a&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">     	&lt;form action=<span class="string">&quot;UserServlet?action=findoneuser&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return check()&quot;</span>&gt;</span><br><span class="line">     	&lt;label&gt;请输入要查询的用户ID&lt;br&gt;&lt;br&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;userid&quot;</span> id=<span class="string">&quot;search-uid&quot;</span> /&gt;&lt;/label&gt;&amp;nbsp;</span><br><span class="line">     	&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;准确查询&quot;</span> &gt;</span><br><span class="line">     	&lt;/form&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">     	</span><br><span class="line">     	&lt;form action=<span class="string">&quot;UserServlet?action=findsomeuser&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return check2()&quot;</span>&gt;</span><br><span class="line">     	&lt;label&gt;请输入要查询的字段&lt;br&gt;&lt;br&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;userdate&quot;</span> id=<span class="string">&quot;search-uname&quot;</span>/&gt;&lt;/label&gt;&amp;nbsp;</span><br><span class="line">     	&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;模糊查询&quot;</span> &gt;</span><br><span class="line">     	&lt;/form&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">		&lt;/table&gt;	</span><br><span class="line">		共&lt;%=pagecount %&gt;页，当前&lt;%=currentpage %&gt;/&lt;%=pagecount %&gt;页，&amp;nbsp;&amp;nbsp;</span><br><span class="line">		&lt;%<span class="keyword">if</span>(currentpage&lt;pagecount &amp;&amp; currentpage &gt;<span class="number">0</span>)&#123; %&gt;</span><br><span class="line">		&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage - 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;上一页&lt;/a&gt; &amp;nbsp;&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage + 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;下一页&lt;/a&gt;</span><br><span class="line">	&lt;%&#125;<span class="keyword">else</span> <span class="keyword">if</span>(currentpage&gt;=pagecount)&#123; %&gt;</span><br><span class="line">		&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage - 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;上一页&lt;/a&gt; &amp;nbsp;&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=pagecount %&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;下一页&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;% &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;%&gt; </span><br><span class="line">		还没登录呢，请先去&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;登录&lt;/a&gt;。</span><br><span class="line">	&lt;%&#125;</span><br><span class="line">	%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h5 id="4、修改用户的流程"><a href="#4、修改用户的流程" class="headerlink" title="4、修改用户的流程"></a>4、修改用户的流程</h5><p>​            用户登陆后，在主界面（success.jsp）的操作栏里，点击修改用户的超连接后，会跳转到updatauser.jsp页面上，随后进入增加用户的MVC的流程。</p>
<p>​            4.1、修改用户的view层（updateuser.jsp）：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">	pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.model.User&quot;</span></span><br><span class="line">	<span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.dao.IUserDao&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;cn.edu.ujn.dao.UserDaoImpl&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;修改用户信息&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">    <span class="comment">//处理分页相关的数据</span></span><br><span class="line">		String pagesize = request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">		String currentpage = request.getParameter(<span class="string">&quot;currentpage&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span> (session.getAttribute(<span class="string">&quot;activeuser&quot;</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">			IUserDao userDao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line">			ArrayList&lt;User&gt; user = userDao.getUserById(Integer.parseInt(request.getParameter(<span class="string">&quot;userid&quot;</span>)));</span><br><span class="line">			</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;form action=<span class="string">&quot;UserServlet?action=updateuser&amp;userid=&lt;%=user.get(0).getId()%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=currentpage %&gt;&quot;</span></span><br><span class="line">		method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        &lt;!-- 添加用户id的只读属性 --&gt;</span><br><span class="line">		Id:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;userid&quot;</span></span><br><span class="line">			value=<span class="string">&quot;&lt;%=user.get(0).getId()%&gt;&quot;</span> readonly=<span class="string">&quot;readonly&quot;</span>/&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt; </span><br><span class="line">		用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span></span><br><span class="line">			value=<span class="string">&quot;&lt;%=user.get(0).getUsername()%&gt;&quot;</span> /&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt; 密码：&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span></span><br><span class="line">			value=<span class="string">&quot;&lt;%=user.get(0).getPassword()%&gt;&quot;</span> /&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt;</span><br><span class="line">        &lt;!--通过代码片的<span class="keyword">if</span>-<span class="keyword">else</span>来实现性别男女的预选--&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">			<span class="keyword">if</span> (user.get(<span class="number">0</span>).getSex().equals(<span class="string">&quot;男&quot;</span>)) &#123;</span><br><span class="line">		%&gt;</span><br><span class="line">		性别：&lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;sex&quot;</span> value=<span class="string">&quot;男&quot;</span> checked&gt;男 &lt;input</span><br><span class="line">			type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;sex&quot;</span> value=<span class="string">&quot;女&quot;</span>&gt;女&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		%&gt;</span><br><span class="line">		性别：&lt;input type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;sex&quot;</span> value=<span class="string">&quot;男&quot;</span>&gt;男 &lt;input</span><br><span class="line">			type=<span class="string">&quot;radio&quot;</span> name=<span class="string">&quot;sex&quot;</span> value=<span class="string">&quot;女&quot;</span> checked&gt;女&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt;</span><br><span class="line">		&lt;%</span><br><span class="line">			&#125;</span><br><span class="line">		%&gt;</span><br><span class="line">		年龄：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;age&quot;</span> value=<span class="string">&quot;&lt;%=user.get(0).getAge()%&gt;&quot;</span>&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt; 爱好：&lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobit&quot;</span> value=<span class="string">&quot;看电影&quot;</span> id=<span class="string">&quot;moive&quot;</span>&gt;看电影</span><br><span class="line">		&lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobit&quot;</span> value=<span class="string">&quot;听音乐&quot;</span> id=<span class="string">&quot;music&quot;</span>&gt;听音乐</span><br><span class="line">		&lt;input type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobit&quot;</span> value=<span class="string">&quot;读书&quot;</span> id=<span class="string">&quot;read&quot;</span>&gt;读书 &lt;input</span><br><span class="line">			type=<span class="string">&quot;checkbox&quot;</span> name=<span class="string">&quot;hobit&quot;</span> value=<span class="string">&quot;跑步&quot;</span> id=<span class="string">&quot;run&quot;</span>&gt;跑步&lt;br&gt;</span><br><span class="line">		&lt;br&gt; 邮箱：&lt;input type=<span class="string">&quot;email&quot;</span> name=<span class="string">&quot;email&quot;</span></span><br><span class="line">			value=<span class="string">&quot;&lt;%=user.get(0).getEmail()%&gt;&quot;</span>&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt; 家庭地址：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;address&quot;</span></span><br><span class="line">			value=<span class="string">&quot;&lt;%=user.get(0).getAddress()%&gt;&quot;</span>&gt;&lt;br /&gt;</span><br><span class="line">		&lt;br /&gt; &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;更新&quot;</span> /&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">    &lt;!--通过代码片加JavaScript的形式来控制爱好复选框的预选，一定要把这一段代码放在表单中的复选框代码的下面，因为html会自上而下解析--&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		<span class="keyword">if</span> (user.get(<span class="number">0</span>).getHobit().contains(<span class="string">&quot;看电影&quot;</span>)) &#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">		document.getElementById(<span class="string">&quot;moive&quot;</span>).checked = <span class="keyword">true</span>;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		&#125;</span><br><span class="line">			<span class="keyword">if</span> (user.get(<span class="number">0</span>).getHobit().contains(<span class="string">&quot;听音乐&quot;</span>)) &#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">		document.getElementById(<span class="string">&quot;music&quot;</span>).checked = <span class="keyword">true</span>;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		&#125;</span><br><span class="line">			<span class="keyword">if</span> (user.get(<span class="number">0</span>).getHobit().contains(<span class="string">&quot;读书&quot;</span>)) &#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">		document.getElementById(<span class="string">&quot;read&quot;</span>).checked = <span class="keyword">true</span>;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		&#125;</span><br><span class="line">			<span class="keyword">if</span> (user.get(<span class="number">0</span>).getHobit().contains(<span class="string">&quot;跑步&quot;</span>)) &#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">		document.getElementById(<span class="string">&quot;run&quot;</span>).checked = <span class="keyword">true</span>;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	&lt;%</span><br><span class="line">		&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	%&gt;</span><br><span class="line">	还没登录呢，请先&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;登录&lt;/a&gt;。</span><br><span class="line">	&lt;%</span><br><span class="line">		&#125;</span><br><span class="line">	%&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>​        4.2、增加用户的controller层（servlet）：</p>
<p>​        action的值为updateuser</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;updateuser&quot;</span>)) &#123;</span><br><span class="line">	String pagesize = request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">	String pagecount = request.getParameter(<span class="string">&quot;currentpage&quot;</span>);</span><br><span class="line">	String sex = request.getParameter(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> age = Integer.parseInt(request.getParameter(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">	String[] hobits = request.getParameterValues(<span class="string">&quot;hobit&quot;</span>);</span><br><span class="line">	String hobit = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;hobits.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">		hobit = hobit + hobits[i] + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	hobit = hobit + hobits[hobits.length-<span class="number">1</span>];</span><br><span class="line">	String email = request.getParameter(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">	String address = request.getParameter(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">	User user = <span class="keyword">new</span> User();</span><br><span class="line">	user.setPassword(password);</span><br><span class="line">	user.setUsername(username);</span><br><span class="line">	user.setSex(sex);</span><br><span class="line">	user.setAge(age);</span><br><span class="line">	user.setHobit(hobit);</span><br><span class="line">	user.setEmail(email);</span><br><span class="line">	user.setAddress(address);</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (userDao.updateUser(Integer.parseInt(request.getParameter(<span class="string">&quot;userid&quot;</span>)),user)) &#123;</span><br><span class="line">                  <span class="comment">//添加成功之后带着分页方面的信息到findallsub方法，接下来还是在controller层中</span></span><br><span class="line">			response.sendRedirect(<span class="string">&quot;UserServlet?action=findallsub&amp;pagesize=&quot;</span>+pagesize+<span class="string">&quot;&amp;currentpage=&quot;</span>+pagecount);</span><br><span class="line">		&#125; <span class="keyword">else</span></span><br><span class="line">			response.getWriter().println(<span class="string">&quot;更新失败！&quot;</span>);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">		e.printStackTrace();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        findallsub（）：</p>
<p>​        以分页的形式查询所有的用户信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;findallsub&quot;</span>)) &#123;</span><br><span class="line">			<span class="keyword">int</span> currentpage;</span><br><span class="line">			<span class="keyword">if</span>(Integer.parseInt(request.getParameter(<span class="string">&quot;currentpage&quot;</span>))&lt;=<span class="number">0</span>) &#123;</span><br><span class="line">				currentpage = <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				currentpage = Integer.parseInt(request.getParameter(<span class="string">&quot;currentpage&quot;</span>));</span><br><span class="line">			&#125;</span><br><span class="line">			ArrayList&lt;User&gt; userlist=userDao.findUsers(currentpage,Integer.parseInt(request.getParameter(<span class="string">&quot;pagesize&quot;</span>)));</span><br><span class="line">			request.setAttribute(<span class="string">&quot;userList&quot;</span>, userlist);</span><br><span class="line">    <span class="comment">//查询完成后跳转到success.jsp</span></span><br><span class="line">			request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​    4.3、增加用户的model层（Dao层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateUser</span><span class="params">(<span class="keyword">int</span> id,User user)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		Connection con = DBHelper.getConnection();</span><br><span class="line">		String sql = <span class="string">&quot;update user set username=?,password=?,sex=?,age=?,hobit=?,email=?,address=? where id=?&quot;</span>;</span><br><span class="line">		PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">		st.setString(<span class="number">1</span>, user.getUsername());</span><br><span class="line">		st.setString(<span class="number">2</span>, user.getPassword());	</span><br><span class="line">		st.setString(<span class="number">3</span>, user.getSex());</span><br><span class="line">		st.setInt(<span class="number">4</span>, user.getAge());</span><br><span class="line">		st.setString(<span class="number">5</span>, user.getHobit());</span><br><span class="line">		st.setString(<span class="number">6</span>, user.getEmail());</span><br><span class="line">		st.setString(<span class="number">7</span>, user.getAddress());</span><br><span class="line">		st.setInt(<span class="number">8</span>, id);</span><br><span class="line">           <span class="comment">//返回更新成功的条数</span></span><br><span class="line">		<span class="keyword">int</span> n = st.executeUpdate();</span><br><span class="line">		st.close();</span><br><span class="line">		con.close();</span><br><span class="line">		<span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">		System.out.println(ce);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>findUser（）见上；</p>
<h5 id="5、删除用户"><a href="#5、删除用户" class="headerlink" title="5、删除用户"></a>5、删除用户</h5><p>​    5.1、用户在主界面（success.jsp）中点击删除用户超链接后，代码会直接进入controller层（servlet）</p>
<p>​    5.2、删除用户的controller层（servlet）:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;deleteoneuser&quot;</span>)) &#123;</span><br><span class="line">			String pagesize = request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">			String currentpage = request.getParameter(<span class="string">&quot;currentpage&quot;</span>);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (userDao.deleteUserById(Integer.parseInt(request.getParameter(<span class="string">&quot;userid&quot;</span>)))) &#123;</span><br><span class="line">                    <span class="comment">//删除成功后通过findallsub，通过分页的形式再次显示success.jsp</span></span><br><span class="line">					response.sendRedirect(<span class="string">&quot;UserServlet?action=findallsub&amp;pagesize=&quot;</span>+pagesize+<span class="string">&quot;&amp;currentpage=&quot;</span>+currentpage);</span><br><span class="line">				&#125; <span class="keyword">else</span></span><br><span class="line">					response.getWriter().println(<span class="string">&quot;删除失败！&quot;</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​    5.3、通过用户的id来删除用户的model层（Dao层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection(); </span><br><span class="line">			String sql = <span class="string">&quot;delete from user where id=?&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">			st.setInt(<span class="number">1</span>, id);</span><br><span class="line">			st.executeUpdate();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6、增加一名用户"><a href="#6、增加一名用户" class="headerlink" title="6、增加一名用户"></a>6、增加一名用户</h5><p>​    6.1、用户在主界面上（success.jsp）上点击超连接 ‘ 增加一名用户 ’，会进入adduser.jsp,接下里的流程与注册（register）的流程类似。</p>
<p>​    6.2、增加用户的view层（adduser.jsp）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;增加用户&lt;/title&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line">	<span class="function">function <span class="title">check</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">var</span> inputdate = document.getElementById(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入用户名&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入密码&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入年龄&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入邮箱&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		inputdate = document.getElementById(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">		<span class="keyword">if</span>(inputdate.value==<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">			alert(<span class="string">&quot;请输入地址&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">	String currentpage = request.getParameter(<span class="string">&quot;currentpage&quot;</span>);</span><br><span class="line">	String pagesize = request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%<span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;activeuser&quot;</span>)!=<span class="keyword">null</span>)&#123; %&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;UserServlet?action=adduser&amp;pagesize=&lt;%=pagesize %&gt;&amp;currentpage=&lt;%=currentpage %&gt;&quot;</span> method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return check()&quot;</span>&gt;</span><br><span class="line">  	用户名：&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span> id=<span class="string">&quot;username&quot;</span>/&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	密码：&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span> id=<span class="string">&quot;password&quot;</span> /&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	性别：&lt;input type=<span class="string">&quot;radio&quot;</span> name =<span class="string">&quot;sex&quot;</span> value =<span class="string">&quot;男&quot;</span>&gt;男</span><br><span class="line">  		&lt;input type=<span class="string">&quot;radio&quot;</span> name =<span class="string">&quot;sex&quot;</span> value =<span class="string">&quot;女&quot;</span>&gt;女&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	年龄：&lt;input type=<span class="string">&quot;text&quot;</span> name =<span class="string">&quot;age&quot;</span>  id=<span class="string">&quot;age&quot;</span> &gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	爱好：&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;看电影&quot;</span>&gt;看电影</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;听音乐&quot;</span>&gt;听音乐</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;读书&quot;</span>&gt;读书</span><br><span class="line">  		&lt;input type =<span class="string">&quot;checkbox&quot;</span> name =<span class="string">&quot;hobit&quot;</span> value = <span class="string">&quot;跑步&quot;</span>&gt;跑步&lt;br&gt;&lt;br&gt;</span><br><span class="line">  	邮箱：&lt;input type=<span class="string">&quot;email&quot;</span> name = <span class="string">&quot;email&quot;</span> id=<span class="string">&quot;email&quot;</span>  &gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	家庭地址：&lt;input type =<span class="string">&quot;text&quot;</span> name =<span class="string">&quot;address&quot;</span> id=<span class="string">&quot;address&quot;</span>&gt;&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">  	&lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;插入用户&quot;</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;%&#125;<span class="keyword">else</span>&#123;%&gt;</span><br><span class="line">	还没登录呢，请先去&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;登录&lt;/a&gt;。</span><br><span class="line">&lt;%&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>​        6.3、增加用户的controller层（servlet）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;adduser&quot;</span>)) &#123;</span><br><span class="line">			String pagesize = request.getParameter(<span class="string">&quot;pagesize&quot;</span>);</span><br><span class="line">			String currentpage = request.getParameter(<span class="string">&quot;currentpage&quot;</span>);</span><br><span class="line">			String sex = request.getParameter(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">			<span class="keyword">int</span> age = Integer.parseInt(request.getParameter(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">			String[] hobits = request.getParameterValues(<span class="string">&quot;hobit&quot;</span>);</span><br><span class="line">			String hobit = <span class="string">&quot;&quot;</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;hobits.length-<span class="number">1</span>; i++) &#123;</span><br><span class="line">				hobit = hobit + hobits[i] + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			hobit = hobit + hobits[hobits.length-<span class="number">1</span>];</span><br><span class="line">			String email = request.getParameter(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">			String address = request.getParameter(<span class="string">&quot;address&quot;</span>);</span><br><span class="line">			User user = <span class="keyword">new</span> User();</span><br><span class="line">			user.setPassword(password);</span><br><span class="line">			user.setUsername(username);</span><br><span class="line">			user.setSex(sex);</span><br><span class="line">			user.setAge(age);</span><br><span class="line">			user.setHobit(hobit);</span><br><span class="line">			user.setEmail(email);</span><br><span class="line">			user.setAddress(address);</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> (userDao.addUser(user)) &#123;</span><br><span class="line">					response.sendRedirect(<span class="string">&quot;UserServlet?action=findallsub&amp;pagesize=&quot;</span>+pagesize+<span class="string">&quot;&amp;currentpage=&quot;</span>+currentpage);</span><br><span class="line">				&#125; <span class="keyword">else</span></span><br><span class="line">					response.getWriter().println(<span class="string">&quot;插入失败！&quot;</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​        6.4、增加用户的model层（Dao层）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection();</span><br><span class="line">			String sql = <span class="string">&quot;insert into user(username,password,sex,age,hobit,email,address) values(?,?,?,?,?,?,?)&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">			st.setString(<span class="number">1</span>, user.getUsername());</span><br><span class="line">			st.setString(<span class="number">2</span>, user.getPassword());	</span><br><span class="line">			st.setString(<span class="number">3</span>, user.getSex());</span><br><span class="line">			st.setInt(<span class="number">4</span>, user.getAge());</span><br><span class="line">			st.setString(<span class="number">5</span>, user.getHobit());</span><br><span class="line">			st.setString(<span class="number">6</span>, user.getEmail());</span><br><span class="line">			st.setString(<span class="number">7</span>, user.getAddress());</span><br><span class="line">			<span class="keyword">int</span> n = st.executeUpdate();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">if</span> (n &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7、精准查询"><a href="#7、精准查询" class="headerlink" title="7、精准查询"></a>7、精准查询</h5><p>​        7.1、源码中精准查询是通过查找id来实现的</p>
<p>​        7.2、在success中建立一个表单（form），内写一个输入框用来输入要查询的id，用户点击按钮后即进入精准查询的controller层</p>
<p>​        7.3、精准查询的controller层：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;findoneuser&quot;</span>)) &#123;</span><br><span class="line">			<span class="keyword">if</span>(request.getParameter(<span class="string">&quot;userid&quot;</span>)!=<span class="keyword">null</span> &amp;&amp; !request.getParameter(<span class="string">&quot;userid&quot;</span>).equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">			ArrayList&lt;User&gt; user=userDao.getUserById(Integer.parseInt(request.getParameter(<span class="string">&quot;userid&quot;</span>)));</span><br><span class="line">			<span class="keyword">if</span>(user != <span class="keyword">null</span> &amp;&amp; user.size()!=<span class="number">0</span>) </span><br><span class="line">				request.setAttribute(<span class="string">&quot;userList&quot;</span>, user);</span><br><span class="line">				request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				ArrayList&lt;User&gt; userlist=userDao.findAllUsers();</span><br><span class="line">				request.setAttribute(<span class="string">&quot;userList&quot;</span>, userlist);</span><br><span class="line">				request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">			&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>​        7.4、精准查询的model层（Dao层）：</p>
<p>此处的返回值其实应该设置为User，但是我已经这样写了，就不想再改了 : (，实现方法是一样的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;User&gt; <span class="title">getUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		User user = <span class="keyword">null</span>;</span><br><span class="line">		ArrayList&lt;User&gt; userList=<span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection(); </span><br><span class="line">			String sql = <span class="string">&quot;select * from user where id=?&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">			st.setInt(<span class="number">1</span>, id);</span><br><span class="line">			ResultSet rs = st.executeQuery();</span><br><span class="line">			<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">				user = <span class="keyword">new</span> User();</span><br><span class="line">				user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">				user.setUsername(rs.getString(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">				user.setPassword(rs.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">				user.setSex(rs.getString(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line">				user.setAge(rs.getInt(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">				user.setHobit(rs.getString(<span class="string">&quot;hobit&quot;</span>));</span><br><span class="line">				user.setEmail (rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">				user.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">				userList.add(user);</span><br><span class="line">			&#125;</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">return</span> userList;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="8、模糊查询"><a href="#8、模糊查询" class="headerlink" title="8、模糊查询"></a>8、模糊查询</h5><p>本质上与精准查询的实现方法是一致的，只有Dao的sql语句不一样，其他的大多相同，直接上代码吧</p>
<p>Controller层：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(action.equals(<span class="string">&quot;findsomeuser&quot;</span>)) &#123;</span><br><span class="line">			ArrayList&lt;User&gt; user=userDao.getSomeUser(request.getParameter(<span class="string">&quot;userdate&quot;</span>));</span><br><span class="line">			<span class="keyword">if</span>(user != <span class="keyword">null</span> &amp;&amp; user.size()!=<span class="number">0</span>) &#123;</span><br><span class="line">				request.setAttribute(<span class="string">&quot;userList&quot;</span>, user);</span><br><span class="line">				request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">			&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">				ArrayList&lt;User&gt; userlist=userDao.findAllUsers();</span><br><span class="line">				request.setAttribute(<span class="string">&quot;userList&quot;</span>, userlist);</span><br><span class="line">				request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>Dao层：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ArrayList&lt;User&gt; <span class="title">getSomeUser</span><span class="params">(String userdate)</span> </span>&#123;</span><br><span class="line">		User user = <span class="keyword">null</span>;</span><br><span class="line">		ArrayList&lt;User&gt; userList=<span class="keyword">new</span> ArrayList&lt;User&gt;();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection(); </span><br><span class="line">            <span class="comment">//注意这里的sql语句的写法，以及后面的like concat(&#x27;%&#x27;,?,&#x27;%&#x27;)</span></span><br><span class="line">			String sql = <span class="string">&quot;SELECT * FROM user Where username like concat(&#x27;%&#x27;,?,&#x27;%&#x27;)&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">			st.setString(<span class="number">1</span>, userdate);</span><br><span class="line">			ResultSet rs = st.executeQuery();</span><br><span class="line">			<span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">				user = <span class="keyword">new</span> User();</span><br><span class="line">				user.setId(rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">				user.setUsername(rs.getString(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">				user.setPassword(rs.getString(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">				user.setSex(rs.getString(<span class="string">&quot;sex&quot;</span>));</span><br><span class="line">				user.setAge(rs.getInt(<span class="string">&quot;age&quot;</span>));</span><br><span class="line">				user.setHobit(rs.getString(<span class="string">&quot;hobit&quot;</span>));</span><br><span class="line">				user.setEmail (rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">				user.setAddress(rs.getString(<span class="string">&quot;address&quot;</span>));</span><br><span class="line">				userList.add(user);</span><br><span class="line">			&#125;</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">			<span class="keyword">return</span> userList;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="9、全局模糊查询"><a href="#9、全局模糊查询" class="headerlink" title="9、全局模糊查询"></a>9、全局模糊查询</h5><p>（源码里没写，这里仅提供sql的写法，是否可行我也没有试）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id, </span><br><span class="line">	username, </span><br><span class="line">	password, </span><br><span class="line">	sex, </span><br><span class="line">	age, </span><br><span class="line">	email,</span><br><span class="line">	hobit,</span><br><span class="line">	<span class="function">address</span></span><br><span class="line"><span class="function">FROM user as a WHERE <span class="title">CONCAT</span><span class="params">(id,username,password,sex,age,email,hobit,address)</span> LIKE <span class="title">CONCAT</span><span class="params">(<span class="string">&#x27;%&#x27;</span>, ? , <span class="string">&#x27;%&#x27;</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<h5 id="10、用户的退出"><a href="#10、用户的退出" class="headerlink" title="10、用户的退出"></a>10、用户的退出</h5><p>整体思想就是在session中把存用户名的字段remove掉</p>
<p>具体代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;用户退出&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//判断session中的用户信息是否存在</span></span><br><span class="line">	<span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;activeuser&quot;</span>) !=<span class="keyword">null</span> )&#123;</span><br><span class="line">		session.removeAttribute(<span class="string">&quot;activeuser&quot;</span>);</span><br><span class="line">        <span class="comment">//判断是否成功remove用户信息</span></span><br><span class="line">		<span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;activeuser&quot;</span>) ==<span class="keyword">null</span>)&#123;</span><br><span class="line">			out.println(<span class="string">&quot;退出成功！3秒后跳转到登录页面&quot;</span>);</span><br><span class="line">			response.setHeader(<span class="string">&quot;refresh&quot;</span>, <span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			out.println(<span class="string">&quot;退出失败！&quot;</span>);</span><br><span class="line">			request.getRequestDispatcher(<span class="string">&quot;success.jsp&quot;</span>).forward(request, response);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		%&gt;</span><br><span class="line">		还没登录呢，请先去&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;登录&lt;/a&gt;。</span><br><span class="line">		&lt;%</span><br><span class="line">	&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h5 id="11、关于分页有几点想说的"><a href="#11、关于分页有几点想说的" class="headerlink" title="11、关于分页有几点想说的"></a>11、关于分页有几点想说的</h5><p>​    11.1、源码中的分页实现了以下几点：①可以实现在第一页（最后一页）的情况下点击上一页（下一页），仍然在第一页（最后一页）。②在非第一页的情况下，删除（修改）一条数据，不会跳转到第一页，会继续在当前页显示信息。</p>
<p>​    12.2、就以上两点展开实现原理的讲解</p>
<p>​    首先，我们要实现分页，就要设置在一个页面上显示多少条数（pagesize）、还有当前页面是第几页（currentpage）以及通过数据库中数据条数和pagesize计算出来的显示总页数（pagecount）</p>
<p>​    在该系统中，我没有设置单页显示数量的可选值，我喜欢数字7，所以我在整个程序中都定义了，pagesize=7。如果要实现单页显示数量的用户自定义可选，可以设置一个下拉框，并通过JavaScript获取里面的值，来定义到pagesize上。</p>
<p>以下是我实现分页以及实现修改删除不跳页面的几段关键代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//这是success.jsp上设置的分页三个重要值得方法</span></span><br><span class="line">	<span class="keyword">int</span> currentpage=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> pagesize = <span class="number">7</span>;</span><br><span class="line">	IUserDao userdao = <span class="keyword">new</span> UserDaoImpl();</span><br><span class="line"><span class="comment">//调用Dao层，通过数据库中的数据的条数来计算出pagecount</span></span><br><span class="line">	<span class="keyword">int</span> pagecount = userdao.getPageCount(pagesize);</span><br><span class="line">	<span class="keyword">if</span>(request.getParameter(<span class="string">&quot;currentpage&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">		currentpage = Integer.parseInt(request.getParameter(<span class="string">&quot;currentpage&quot;</span>));</span><br><span class="line">        <span class="comment">//限制到达第一页了，就不能再让currentpage再减小了，即在第一页点击上一页不起作用</span></span><br><span class="line">		currentpage = currentpage&lt;<span class="number">1</span>?<span class="number">1</span>:currentpage;</span><br><span class="line">	&#125;</span><br><span class="line">	%&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">共&lt;%=pagecount %&gt;页，当前&lt;%=currentpage %&gt;/&lt;%=pagecount %&gt;页，&amp;nbsp;&amp;nbsp;</span><br><span class="line">		&lt;%<span class="keyword">if</span>(currentpage&lt;pagecount &amp;&amp; currentpage &gt;<span class="number">0</span>)&#123; %&gt;</span><br><span class="line">		&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage - 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;上一页&lt;/a&gt; &amp;nbsp;&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage + 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;下一页&lt;/a&gt;</span><br><span class="line">	&lt;%&#125;<span class="keyword">else</span> <span class="keyword">if</span>(currentpage&gt;=pagecount)&#123; %&gt;</span><br><span class="line">		&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=currentpage - 1%&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;上一页&lt;/a&gt; &amp;nbsp;&lt;a href =<span class="string">&quot;UserServlet?action=findallsub&amp;currentpage=&lt;%=pagecount %&gt;&amp;pagesize=&lt;%=pagesize %&gt;&quot;</span>&gt;下一页&lt;/a&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;% &#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>上面这两条代码写的很乱，仔细分析一下，另外还有一点在实现页面之间跳转的同时，要根据需要带着pagesize、currentpage和pagecount三个变量。具体逻辑要在整个源码中分析。</p>
<p>userdao.getPageCount（）：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPageCount</span><span class="params">(<span class="keyword">int</span> pagesize)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Connection con = DBHelper.getConnection(); </span><br><span class="line">			String sql = <span class="string">&quot;SELECT count(*) FROM user&quot;</span>;</span><br><span class="line">			PreparedStatement st = con.prepareStatement(sql);</span><br><span class="line">			ResultSet rs = st.executeQuery();</span><br><span class="line">			<span class="keyword">int</span> records=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(rs.next()) &#123;</span><br><span class="line">				records = rs.getInt(<span class="number">1</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			rs.close();</span><br><span class="line">			st.close();</span><br><span class="line">			con.close();</span><br><span class="line">            <span class="comment">//通过总条数（records）和单页条数（pagesize）计算要分几页</span></span><br><span class="line">			<span class="keyword">return</span> (records-<span class="number">1</span>)/pagesize+<span class="number">1</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ce) &#123;</span><br><span class="line">			System.out.println(ce);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="五、数据库方面的补充（DBHelper）"><a href="#五、数据库方面的补充（DBHelper）" class="headerlink" title="五、数据库方面的补充（DBHelper）"></a>五、数据库方面的补充（DBHelper）</h4><p>因为dao层中的所有方法在进行操作时都要进行数据库的连接操作，所以就把数据库的连接操作写成了一个类，在每次需要的时候拿出来调用即可</p>
<p>DBHelper.java:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.edu.ujn.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBHelper</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String driver = <span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="comment">//数据库的连接地址，以及传输过程中用什么样的字符集</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String url = <span class="string">&quot;jdbc:mysql://localhost:3306/jsp?useUnicode=true&amp;characterEncoding=UTF-8&quot;</span>;</span><br><span class="line">    <span class="comment">//数据库的用户名和密码</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String username = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String password = <span class="string">&quot;root123&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Connection conn = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  静态代码块负责加载驱动</span></span><br><span class="line"><span class="comment">//  一般情况下,如果有些代码必须在项目启动的时候就执行的时候,需要使用静态代码块,这种代码是主动执行的，且优先于主函数。</span></span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(driver);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (conn == <span class="keyword">null</span> || conn.isClosed()) &#123;</span><br><span class="line">			conn = DriverManager.getConnection(url, username, password);</span><br><span class="line">			<span class="keyword">return</span> conn;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数据库里的信息如下：</p>
<p><img src="%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BF%A1%E6%81%AF.png" alt="数据库信息"></p>
<h4 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h4><p>源码还有很多地方需要完善，比如在进行模糊查询和精准查询时，因为还是在success.jsp里面显示的信息，所以<strong>没有实现查询之后的信息的分页展示</strong>，当时想了一种方法，比如在查询完成后会再次获取一遍records重新计算一遍pagecount就可以了。还有就是虽然限制了注册时不允许重复用户名，但是<strong>依然存在更新时修改用户名，也可能出现重复用户名的问题</strong>，如果依然调用注册时的检验方法checkUserName()会出现，不修改用户名不能更新的情况，因为要修改的用户一定已经在数据库中了，所以调用checkUsername()的结果一定是true。对于这一问题，可以在写一个查询方法updateCheckUsername()，检验方法设置成查询出来的相同用户名的那一条信息与当前正在修改的用户的信息进行id的比对，如果一样则允许进行修改，如果不一样则不允许进行修改。</p>
<p><u><em>2021.10.25  杜沐Pro in UJN</em></u></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Jsp/" rel="tag"># -Jsp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/10/15/%E5%8D%83%E8%AF%8D%E7%99%BE%E7%BB%83Unit11-15/" rel="prev" title="千词百练Unit11-15">
                  <i class="fa fa-chevron-left"></i> 千词百练Unit11-15
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/10/30/hexo-%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/" rel="next" title="hexo 博客使用教程">
                  hexo 博客使用教程 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">杜沐</span>
</div>
<div class="busuanzi-count">
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
